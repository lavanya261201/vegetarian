webpackJsonp(["preview"],{"./client/my-sites/preview/controller.js":function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n("./node_modules/react/react.js"),l=i(s),o=n("./client/my-sites/preview/main.jsx"),a=i(o);t.default={preview:function(e,t){e.primary=l.default.createElement(a.default,{site:e.params.site}),t()}},e.exports=t.default},"./client/my-sites/preview/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e("/view",s.siteSelection,s.sites),e("/view/:site",s.siteSelection,s.makeNavigation,l.preview,i.makeLayout)};var i=n("./client/controller/index.web.js"),s=n("./client/my-sites/controller.js"),l=n("./client/my-sites/preview/controller.js");e.exports=t.default},"./client/my-sites/preview/main.jsx":function(e,t,n){"use strict";(function(i){function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=n("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),o=s(l),a=n("./node_modules/babel-runtime/helpers/classCallCheck.js"),r=s(a),u=n("./node_modules/babel-runtime/helpers/createClass.js"),d=s(u),c=n("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),p=s(c),f=n("./node_modules/babel-runtime/helpers/inherits.js"),m=s(f),v=n("./node_modules/lodash/debounce.js"),h=s(v),w=n("./node_modules/react-redux/es/index.js"),y=n("./node_modules/i18n-calypso/index.js"),b=n("./node_modules/react/react.js"),j=s(b),_=n("./node_modules/debug/browser.js"),x=s(_),U=n("./client/state/ui/selectors.js"),g=n("./client/state/sites/selectors.js"),L=n("./client/lib/route/add-query-args.js"),S=s(L),k=n("./client/state/ui/layout-focus/actions.js"),C=n("./client/lib/viewport/index.js"),E=n("./client/components/button/index.jsx"),P=s(E),M=n("./client/components/data/document-head/index.jsx"),O=s(M),I=n("./client/components/empty-content/index.jsx"),R=s(I),W=n("./node_modules/gridicons/build/index.js"),z=s(W),B=n("./client/components/main/index.jsx"),F=s(B),N=n("./client/components/web-preview/content.jsx"),D=s(N),q=(0,x.default)("calypso:my-sites:preview"),A=function(e){function t(){var e,n,i,s;(0,r.default)(this,t);for(var l=arguments.length,a=Array(l),u=0;u<l;u++)a[u]=arguments[u];return n=i=(0,p.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(a))),i.state={previewUrl:null,externalUrl:null,showingClose:!1},i.updateLayout=function(){i.setState({showingClose:(0,C.isWithinBreakpoint)("<660px")})},i.debouncedUpdateLayout=(0,h.default)(i.updateLayout,50),i.updateSiteLocation=function(e){i.setState({externalUrl:i.props.site.URL+("/"===e?"":e)})},i.focusSidebar=function(){i.props.setLayoutFocus("sidebar")},s=n,(0,p.default)(i,s)}return(0,m.default)(t,e),(0,d.default)(t,[{key:"componentWillMount",value:function(){this.updateUrl(),this.updateLayout()}},{key:"componentDidMount",value:function(){i.window&&i.window.addEventListener("resize",this.debouncedUpdateLayout)}},{key:"componentWillUnmount",value:function(){i.window&&i.window.removeEventListener("resize",this.debouncedUpdateLayout)}},{key:"updateUrl",value:function(){if(!this.props.site)return void(null!==this.state.previewUrl&&(q("unloaded page"),this.setState({previewUrl:null,externalUrl:null})));var e=this.getBasePreviewUrl(),t=(0,S.default)({theme_preview:!0,iframe:!0,"frame-nonce":this.props.site.options.frame_nonce},e);this.iframeUrl!==t&&(q("loading",t),this.setState({previewUrl:t,externalUrl:this.props.site.URL}))}},{key:"getBasePreviewUrl",value:function(){return this.props.site.options.unmapped_url}},{key:"componentDidUpdate",value:function(e){this.props.siteId!==e.siteId&&(q("site change detected"),this.updateUrl())}},{key:"render",value:function(){var e=this.props,t=e.translate,n=e.isPreviewable,i=e.site;if(!i)return null;if(!n){var s=j.default.createElement(P.default,{primary:!0,icon:!0,href:i.URL,target:"_blank"},t("Open")," ",j.default.createElement(z.default,{icon:"external"}));return j.default.createElement(R.default,{title:t("Unable to show your site here"),line:t("To view your site, click the button below"),action:s,illustration:"/calypso/images/illustrations/illustration-404.svg",illustrationWidth:350})}return j.default.createElement(F.default,{className:"preview"},j.default.createElement(O.default,{title:t("Your Site")}),j.default.createElement(D.default,{onLocationUpdate:this.updateSiteLocation,showUrl:!!this.state.externalUrl,showClose:this.state.showingClose,onClose:this.focusSidebar,previewUrl:this.state.previewUrl,externalUrl:this.state.externalUrl,loadingMessage:this.props.translate("{{strong}}One moment, pleaseâ€¦{{/strong}} loading your site.",{components:{strong:j.default.createElement("strong",null)}})}))}}]),t}(j.default.Component);A.displayName="Preview";var J=function(e){var t=(0,U.getSelectedSiteId)(e);return{isPreviewable:(0,g.isSitePreviewable)(e,t),site:(0,U.getSelectedSite)(e),siteId:t}};t.default=(0,w.connect)(J,{setLayoutFocus:k.setLayoutFocus})((0,y.localize)(A)),e.exports=t.default}).call(t,n("./node_modules/webpack/buildin/global.js"))}});