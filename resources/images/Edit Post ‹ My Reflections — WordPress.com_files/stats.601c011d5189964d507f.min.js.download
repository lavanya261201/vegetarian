webpackJsonp(["stats"],{"./client/lib/follow-list/index.js":function(t,e,s){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function i(){return this instanceof i?void(this.data=[]):new i}var n=s("./node_modules/lodash/find.js"),o=a(n),l=s("./client/lib/follow-list/site.js");i.prototype.add=function(t){var e=this.siteExists(t.site_id);return e||(e=new l(t),this.data.push(e)),e},i.prototype.siteExists=function(t){return(0,o.default)(this.data,{site_id:t})||!1},t.exports=i},"./client/lib/follow-list/site.js":function(t,e,s){"use strict";function a(t){return this instanceof a?(this.site_id=t.site_id,this.is_following=t.is_following,void(this.blog_domain=t.blog_domain)):new a(t)}var i=s("./node_modules/debug/browser.js")("calypso:follow-list:site"),n=s("./client/lib/wp/browser.js"),o=s("./client/lib/mixins/emitter/index.js");o(a.prototype),a.prototype.follow=function(){this.is_following||(i("following site",this.site_id),this.is_following=!0,this.emit("change"),n.site(this.site_id).follow().add(function(t){i("follow success",t)}))},a.prototype.unfollow=function(){this.is_following&&(this.is_following=!1,this.emit("change"),n.site(this.site_id).follow().del(function(t){i("unfollow success",t)}))},t.exports=a},"./client/my-sites/stats/controller.jsx":function(t,e,s){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function i(t,e){var s={period:t,startOf:e.clone().startOf(t),endOf:e.clone().endOf(t)};return"week"===t&&("0"===e.format("d")?(s.startOf.subtract(6,"d"),s.endOf.subtract(6,"d")):(s.startOf.add(1,"d"),s.endOf.add(1,"d"))),s.key=t+":"+s.endOf.format("YYYY-MM-DD"),s}function n(t,e,s){var a=t.endOf(s),i=_.default.moment.duration(a.diff(e)),n=void 0;switch(s){case"day":n=i.asDays();break;case"week":n=i.asWeeks();break;case"month":n=i.asMonths();break;case"year":n=i.asYears()}return n}function o(t){var e=[{title:_.default.translate("Insights"),path:"/stats/insights/"+t,id:"stats-insights"},{title:_.default.translate("Days"),path:"/stats/day/"+t,id:"stats-day",period:"day"},{title:_.default.translate("Weeks"),path:"/stats/week/"+t,id:"stats-week",period:"week"},{title:_.default.translate("Months"),path:"/stats/month/"+t,id:"stats-month",period:"month"},{title:_.default.translate("Years"),path:"/stats/year/"+t,id:"stats-year",period:"year"}];return e}var l=s("./node_modules/babel-runtime/core-js/number/is-finite.js"),d=a(l),r=s("./node_modules/babel-runtime/helpers/extends.js"),u=a(r),c=s("./node_modules/lodash/pick.js"),f=a(c),m=s("./node_modules/lodash/find.js"),p=a(m),h=s("./node_modules/react/react.js"),y=a(h),g=s("./node_modules/page/index.js"),v=a(g),x=s("./node_modules/i18n-calypso/index.js"),_=a(x),w=s("./client/lib/route/index.js"),j=a(w),S=s("./client/lib/analytics/index.js"),b=a(S),E=s("./node_modules/to-title-case/index.js"),D=a(E),k=s("./client/state/document-head/actions.js"),O=s("./client/lib/react-helpers/index.js"),I=s("./client/state/preferences/actions.js"),M=s("./client/state/sites/selectors.js"),P=s("./client/state/ui/layout-focus/selectors.js"),V=s("./client/state/ui/layout-focus/actions.js"),W=s("./client/state/ui/selectors.js"),q=s("./client/components/async-load/index.jsx"),Y=a(q),L=s("./client/my-sites/stats/stats-page-placeholder/index.jsx"),N=a(L),T="Stats",C=function(t){s.e("async-load-my-sites-stats-stats-insights").then(function(e){t(s("./client/my-sites/stats/stats-insights/index.jsx").__esModule?s("./client/my-sites/stats/stats-insights/index.jsx").default:s("./client/my-sites/stats/stats-insights/index.jsx"))}.bind(null,s)).catch(s.oe)},F=function(t){s.e("async-load-my-sites-stats-overview").then(function(e){t(s("./client/my-sites/stats/overview.jsx").__esModule?s("./client/my-sites/stats/overview.jsx").default:s("./client/my-sites/stats/overview.jsx"))}.bind(null,s)).catch(s.oe)},R=function(t){s.e("async-load-my-sites-stats-site").then(function(e){t(s("./client/my-sites/stats/site.jsx").__esModule?s("./client/my-sites/stats/site.jsx").default:s("./client/my-sites/stats/site.jsx"))}.bind(null,s)).catch(s.oe)},B=function(t){s.e("async-load-my-sites-stats-summary").then(function(e){t(s("./client/my-sites/stats/summary/index.jsx").__esModule?s("./client/my-sites/stats/summary/index.jsx").default:s("./client/my-sites/stats/summary/index.jsx"))}.bind(null,s)).catch(s.oe)},H=function(t){s.e("async-load-my-sites-stats-stats-post-detail").then(function(e){t(s("./client/my-sites/stats/stats-post-detail/index.jsx").__esModule?s("./client/my-sites/stats/stats-post-detail/index.jsx").default:s("./client/my-sites/stats/stats-post-detail/index.jsx"))}.bind(null,s)).catch(s.oe)},$=function(t){s.e("async-load-my-sites-stats-comment-follows").then(function(e){t(s("./client/my-sites/stats/comment-follows/index.jsx").__esModule?s("./client/my-sites/stats/comment-follows/index.jsx").default:s("./client/my-sites/stats/comment-follows/index.jsx"))}.bind(null,s)).catch(s.oe)},z=function(t){s.e("async-load-my-sites-stats-activity-log").then(function(e){t(s("./client/my-sites/stats/activity-log/index.jsx").__esModule?s("./client/my-sites/stats/activity-log/index.jsx").default:s("./client/my-sites/stats/activity-log/index.jsx"))}.bind(null,s)).catch(s.oe)};t.exports={resetFirstView:function(t){t.store.dispatch((0,I.savePreference)("firstViewHistory",[]))},redirectToDefaultSitePage:function(t,e){var s=j.default.getSiteFragment(t.path);if(s){var a=(0,P.getCurrentLayoutFocus)(t.store.getState());t.store.dispatch((0,V.setNextLayoutFocus)(a)),v.default.redirect(j.default.getStatsDefaultSitePage(s))}else e()},insights:function(t){var e=s("./client/lib/follow-list/index.js"),a=t.params.site_id,i=j.default.sectionify(t.path),n=new e;t.store.dispatch((0,k.setDocumentHeadTitle)(_.default.translate("Stats",{textOnly:!0})));var o=(0,M.getSite)(t.store.getState(),a);a=o?o.ID||0:0,b.default.pageView.record(i,T+" > Insights");var l={followList:n};(0,O.renderWithReduxStore)(y.default.createElement(Y.default,(0,u.default)({require:C,placeholder:y.default.createElement(N.default,null)},l)),document.getElementById("primary"),t.store)},overview:function(t,e){var s=function(){return[{title:_.default.translate("Days"),path:"/stats/day",altPaths:["/stats"],id:"stats-day",period:"day"},{title:_.default.translate("Weeks"),path:"/stats/week",id:"stats-week",period:"week"},{title:_.default.translate("Months"),path:"/stats/month",id:"stats-month",period:"month"},{title:_.default.translate("Years"),path:"/stats/year",id:"stats-year",period:"year"}]},a=j.default.sectionify(t.path);window.scrollTo(0,0),t.store.dispatch((0,k.setDocumentHeadTitle)(_.default.translate("Stats",{textOnly:!0})));var i=(0,p.default)(s(),function(e){return t.pathname===e.path||e.altPaths&&-1!==e.altPaths.indexOf(t.pathname)});if(i){b.default.mc.bumpStat("calypso_stats_overview_period",i.period),b.default.pageView.record(a,T+" > "+(0,D.default)(i.period));var n={period:i.period,path:t.pathname};(0,O.renderWithReduxStore)(y.default.createElement(Y.default,(0,u.default)({placeholder:y.default.createElement(N.default,null),require:F},n)),document.getElementById("primary"),t.store)}else e()},site:function(t,e){var s=t.params.site_id,a=o(s),l=t.query,r=void 0,c=void 0,f=void 0,m=0,h=j.default.sectionify(t.path),g=void 0;t.store.dispatch((0,k.setDocumentHeadTitle)(_.default.translate("Stats",{textOnly:!0})));var v=(0,M.getSite)(t.store.getState(),s);s=v?v.ID||0:0;var x=(0,p.default)(a,function(e){return t.pathname===e.path||e.altPaths&&-1!==e.altPaths.indexOf(t.pathname)});if(x){v&&v.domain&&t.store.dispatch((0,k.setDocumentHeadTitle)(_.default.translate("Stats",{textOnly:!0})));var w=(0,M.getSiteOption)(t.store.getState(),s,"gmt_offset"),S=_.default.moment().utcOffset((0,d.default)(w)?w:0);l.startDate&&_.default.moment(l.startDate).isValid()?(r=_.default.moment(l.startDate).locale("en"),m=n(S,r,x.period)):r=i(x.period,S.locale("en")).startOf,m=parseInt(m,10),m?(m>9&&(m="10plus"),m="-"+m):m="",g=h+"/:site",b.default.mc.bumpStat("calypso_stats_site_period",x.period+m),b.default.pageView.record(g,T+" > "+(0,D.default)(x.period)),f=i(x.period,r),c=l.tab||"views";var E={path:t.pathname,date:r,chartTab:c,context:t,period:f};(0,O.renderWithReduxStore)(y.default.createElement(Y.default,(0,u.default)({placeholder:y.default.createElement(N.default,null),require:R},E)),document.getElementById("primary"),t.store)}else e()},summary:function(t,e){var s=t.params.site_id,a=j.default.getSiteFragment(t.path),n=t.query,o=t.params.module,l=[{path:"/stats/"+o+"/"+s,altPaths:["/stats/day/"+o+"/"+s],id:"stats-day",period:"day"},{path:"/stats/week/"+o+"/"+s,id:"stats-week",period:"week"},{path:"/stats/month/"+o+"/"+s,id:"stats-month",period:"month"},{path:"/stats/year/"+o+"/"+s,id:"stats-year",period:"year"}],r=void 0,c=void 0,m=["posts","referrers","clicks","countryviews","authors","videoplays","videodetails","podcastdownloads","searchterms"],h=_.default.moment(),g=j.default.sectionify(t.path),v=(0,M.getSite)(t.store.getState(),s);s=v?v.ID||0:0;var x=(0,p.default)(l,function(e){return t.pathname===e.path||e.altPaths&&-1!==e.altPaths.indexOf(t.pathname)});if(a&&0===s)window.location="/stats";else if(x&&-1!==m.indexOf(t.params.module)){var w=(0,M.getSiteOption)(t.store.getState(),s,"gmt_offset");(0,d.default)(w)&&(h=_.default.moment().utcOffset(w)),r=n.startDate&&_.default.moment(n.startDate).isValid()?_.default.moment(n.startDate):h.endOf(x.period),c=i(x.period,r);var S="videodetails"===t.params.module?{postId:parseInt(n.post,10)}:{},E={};n.summarize&&n.num&&(E=(0,f.default)(n,["num","summarize"]),E.period="day"),b.default.pageView.record(g,T+" > "+(0,D.default)(x.period)+" > "+(0,D.default)(t.params.module));var k=(0,u.default)({path:t.pathname,statsQueryOptions:E,date:r,context:t,period:c},S);(0,O.renderWithReduxStore)(y.default.createElement(Y.default,(0,u.default)({placeholder:y.default.createElement(N.default,null),require:B},k)),document.getElementById("primary"),t.store)}else e()},post:function(t){var e=t.params.site_id,s=parseInt(t.params.post_id,10),a=t.path.split("/"),i="post"===a[2]?"post":"page",n=(0,M.getSite)(t.store.getState(),e);if(e=n?n.ID||0:0,0===e)window.location="/stats";else{b.default.pageView.record("/stats/"+i+"/:post_id/:site",T+" > Single "+(0,D.default)(i));var o={path:t.path,postId:s,context:t};(0,O.renderWithReduxStore)(y.default.createElement(Y.default,(0,u.default)({placeholder:y.default.createElement(N.default,null),require:H},o)),document.getElementById("primary"),t.store)}},follows:function(t){var e=t.params.site_id,a=s("./client/lib/follow-list/index.js"),i=t.params.page_num,n=new a,o=j.default.sectionify(t.path),l=(0,M.getSite)(t.store.getState(),e);e=l?l.ID||0:0;var d=l&&"undefined"!=typeof l.slug?l.slug:j.default.getSiteFragment(t.path);if(0===e)window.location="/stats";else{i=parseInt(i,10),(!i||i<1)&&(i=1),b.default.pageView.record(o.replace("/"+i,""),T+" > Followers > Comment");var r={path:t.path,page:i,perPage:20,total:10,domain:d,siteId:e,followList:n};(0,O.renderWithReduxStore)(y.default.createElement(Y.default,(0,u.default)({placeholder:y.default.createElement(N.default,null),require:$},r)),document.getElementById("primary"),t.store)}},activityLog:function(t){var e=t.store.getState(),s=(0,W.getSelectedSiteId)(e),a=(0,M.isJetpackSite)(e,s),i=_.default.moment(t.query.startDate,"YYYY-MM-DD").isValid()?t.query.startDate:void 0;if(s&&!a)v.default.redirect("/stats");else{b.default.pageView.record("/stats/activity/:site",T+" > Activity ");var n={path:t.path,siteId:s,context:t,startDate:i};(0,O.renderWithReduxStore)(y.default.createElement(Y.default,(0,u.default)({placeholder:y.default.createElement(N.default,null),require:z},n)),document.getElementById("primary"),t.store)}}}},"./client/my-sites/stats/index.js":function(t,e,s){"use strict";var a=s("./node_modules/page/index.js"),i=s("./client/my-sites/controller.js"),n=s("./client/my-sites/stats/controller.jsx"),o=s("./client/config/index.js");t.exports=function(){o.isEnabled("jetpack/activity-log")&&a("/stats/activity/:site_id",i.siteSelection,i.navigation,n.activityLog),o.isEnabled("manage/stats")&&(a("/stats",i.siteSelection,i.navigation,n.overview),a("/stats/day",i.siteSelection,i.navigation,n.overview),a("/stats/week",i.siteSelection,i.navigation,n.overview),a("/stats/month",i.siteSelection,i.navigation,n.overview),a("/stats/year",i.siteSelection,i.navigation,n.overview),a("/stats/insights/:site_id",i.siteSelection,i.navigation,n.insights),a("/stats/day/:site_id",i.siteSelection,i.navigation,n.site),a("/stats/week/:site_id",i.siteSelection,i.navigation,n.site),a("/stats/month/:site_id",i.siteSelection,i.navigation,n.site),a("/stats/year/:site_id",i.siteSelection,i.navigation,n.site),a("/stats/:module/:site_id",i.siteSelection,i.navigation,n.summary),a("/stats/day/:module/:site_id",i.siteSelection,i.navigation,n.summary),a("/stats/week/:module/:site_id",i.siteSelection,i.navigation,n.summary),a("/stats/month/:module/:site_id",i.siteSelection,i.navigation,n.summary),a("/stats/year/:module/:site_id",i.siteSelection,i.navigation,n.summary),a("/stats/post/:post_id/:site_id",i.siteSelection,i.navigation,n.post),a("/stats/page/:post_id/:site_id",i.siteSelection,i.navigation,n.post),a("/stats/follows/comment/:site_id",i.siteSelection,i.navigation,n.follows),a("/stats/follows/comment/:page_num/:site_id",i.siteSelection,i.navigation,n.follows),o.isEnabled("ui/first-view/reset-route")&&a("/stats/reset-first-view",n.resetFirstView),a("/stats/(.*)",i.siteSelection,i.navigation,n.redirectToDefaultSitePage,i.sites))}},"./client/my-sites/stats/stats-page-placeholder/index.jsx":function(t,e,s){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=s("./node_modules/react/react.js"),n=a(i),o=s("./node_modules/classnames/index.js"),l=a(o),d=s("./client/components/card/index.jsx"),r=a(d),u=function(t){return n.default.createElement("div",{className:(0,l.default)("main is-wide-layout",t.className)},n.default.createElement(r.default,{className:"stats-module stats-page-placeholder__header is-loading"},n.default.createElement("div",{className:"module-header"},n.default.createElement("h3",{className:"module-header-title"}))),n.default.createElement(r.default,{className:"stats-module stats-page-placeholder__content is-loading"},n.default.createElement("div",{className:"module-header"},n.default.createElement("h3",{className:"module-header-title"}))))};u.propTypes={className:i.PropTypes.string},e.default=u,t.exports=e.default},"./node_modules/escape-regexp-component/index.js":function(t,e){t.exports=function(t){return String(t).replace(/([.*+?=^!:${}()|[\]\/\\])/g,"\\$1")}},"./node_modules/escape-regexp/index.js":function(t,e){t.exports=function(t){return String(t).replace(/([.*+?=^!:${}()|[\]\/\\])/g,"\\$1")}},"./node_modules/title-case-minors/index.js":function(t,e){t.exports=["a","an","and","as","at","but","by","en","for","from","how","if","in","neither","nor","of","on","only","onto","out","or","per","so","than","that","the","to","until","up","upon","v","v.","versus","vs","vs.","via","when","with","without","yet"]},"./node_modules/to-capital-case/index.js":function(t,e,s){function a(t){return i(t).replace(/(^|\s)(\w)/g,function(t,e,s){return e+s.toUpperCase()})}var i=s("./node_modules/to-capital-case/node_modules/to-no-case/index.js");t.exports=a},"./node_modules/to-capital-case/node_modules/to-no-case/index.js":function(t,e){function s(t){return n.test(t)?t.toLowerCase():(l.test(t)&&(t=a(t)),o.test(t)&&(t=i(t)),t.toLowerCase())}function a(t){return t.replace(d,function(t,e){return e?" "+e:""})}function i(t){return t.replace(r,function(t,e,s){return e+" "+s.toLowerCase().split("").join(" ")})}t.exports=s;var n=/\s/,o=/[a-z][A-Z]/,l=/[\W_]/,d=/[\W_]+(.|$)/g,r=/(.)([A-Z]+)/g},"./node_modules/to-title-case/index.js":function(t,e,s){function a(t){return n(t).replace(d,function(t){return t.toLowerCase()}).replace(r,function(t){return t.toUpperCase()})}try{var i=s("./node_modules/escape-regexp/index.js")}catch(t){var i=s("./node_modules/escape-regexp-component/index.js")}var n=s("./node_modules/to-capital-case/index.js"),o=s("./node_modules/title-case-minors/index.js");t.exports=a;var l=o.map(i),d=new RegExp("[^^]\\b("+l.join("|")+")\\b","ig"),r=/:\s*(\w)/g}});