webpackJsonp(["async-load-post-editor-editor-location"],{"./client/components/search-card/index.jsx":function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o("./node_modules/babel-runtime/helpers/extends.js"),a=r(n),s=o("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=r(s),i=o("./node_modules/babel-runtime/helpers/classCallCheck.js"),c=r(i),d=o("./node_modules/babel-runtime/helpers/createClass.js"),u=r(d),p=o("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),f=r(p),m=o("./node_modules/babel-runtime/helpers/inherits.js"),h=r(m),_=o("./node_modules/react/react.js"),b=r(_),g=o("./node_modules/classnames/index.js"),y=r(g),j=o("./client/components/card/index.jsx"),v=r(j),x=o("./client/components/search/index.jsx"),S=r(x),E=function(e){function t(){var e,o,r,n;(0,c.default)(this,t);for(var a=arguments.length,s=Array(a),i=0;i<a;i++)s[i]=arguments[i];return o=r=(0,f.default)(this,(e=t.__proto__||(0,l.default)(t)).call.apply(e,[this].concat(s))),r.focus=function(){r.refs.search.focus()},r.clear=function(){r.refs.search.clear()},n=o,(0,f.default)(r,n)}return(0,h.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=(0,y.default)("search-card",this.props.className);return b.default.createElement(v.default,{className:e},b.default.createElement(S.default,(0,a.default)({ref:"search"},this.props)))}}]),t}(b.default.Component);E.propTypes={additionalClasses:b.default.PropTypes.string,initialValue:b.default.PropTypes.string,placeholder:b.default.PropTypes.string,delaySearch:b.default.PropTypes.bool,onSearch:b.default.PropTypes.func.isRequired,onSearchChange:b.default.PropTypes.func,analyticsGroup:b.default.PropTypes.string,autoFocus:b.default.PropTypes.bool,disabled:b.default.PropTypes.bool,dir:b.default.PropTypes.string,maxLength:b.default.PropTypes.number,hideOpenIcon:b.default.PropTypes.bool,disableAutocorrect:b.default.PropTypes.bool},t.default=E,e.exports=t.default},"./client/lib/geocoding/index.js":function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function n(e){return new s.default(function(t,o){i.default.get(c).query({address:e}).end(function(e,r){return e||!r.ok||"OK"!==r.body.status?o(e):void t(r.body.results)})})}Object.defineProperty(t,"__esModule",{value:!0});var a=o("./node_modules/babel-runtime/core-js/promise.js"),s=r(a);t.geocode=n;var l=o("./node_modules/superagent/lib/client.js"),i=r(l),c="https://maps.googleapis.com/maps/api/geocode/json"},"./client/post-editor/editor-drawer-well/index.jsx":function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=r(n),s=o("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=r(s),i=o("./node_modules/babel-runtime/helpers/createClass.js"),c=r(i),d=o("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=r(d),p=o("./node_modules/babel-runtime/helpers/inherits.js"),f=r(p),m=o("./node_modules/lodash/identity.js"),h=r(m),_=o("./node_modules/lodash/noop.js"),b=r(_),g=o("./node_modules/react/react.js"),y=r(g),j=o("./node_modules/prop-types/index.js"),v=r(j),x=o("./node_modules/classnames/index.js"),S=r(x),E=o("./node_modules/gridicons/build/index.js"),P=r(E),C=o("./node_modules/i18n-calypso/index.js"),T=o("./client/components/button/index.jsx"),k=r(T),w=function(e){function t(){return(0,l.default)(this,t),(0,u.default)(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return(0,f.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e=this.props,t=e.empty,o=e.onRemove,r=e.onClick,n=e.disabled,a=e.icon,s=e.label,l=e.children,i=e.isHidden,c=(0,S.default)("editor-drawer-well",{"is-empty":t,"is-hidden":i});return y.default.createElement("div",{className:c},y.default.createElement("div",{className:"editor-drawer-well__content"},l,o&&y.default.createElement(k.default,{onClick:o,compact:!0,className:"editor-drawer-well__remove"},y.default.createElement("span",{className:"screen-reader-text"},this.props.translate("Remove")),y.default.createElement(P.default,{icon:"cross",size:24,className:"editor-drawer-well__remove-icon"}))),t&&y.default.createElement("button",{type:"button",onClick:r,disabled:n,className:"editor-drawer-well__placeholder"},a&&y.default.createElement(P.default,{icon:a,className:"editor-drawer-well__icon"}),y.default.createElement("span",{className:"editor-drawer-well__button button is-secondary is-compact"},s)),this.props.customDropZone)}}]),t}(g.Component);w.propTypes={children:v.default.node,disabled:v.default.bool,empty:v.default.bool,icon:v.default.string,isHidden:v.default.bool,label:v.default.node,onClick:v.default.func,customDropZone:v.default.node,onRemove:v.default.func,translate:v.default.func},w.defaultProps={disabled:!1,isHidden:!1,onClick:b.default,onRemove:b.default,translate:h.default},t.default=(0,C.localize)(w),e.exports=t.default},"./client/post-editor/editor-location/index.jsx":function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o("./client/components/notice/index.jsx"),a=r(n),s=o("./node_modules/react/react.js"),l=o("./node_modules/querystring-es3/index.js"),i=o("./client/lib/posts/actions.js"),c=o("./client/post-editor/editor-drawer-well/index.jsx"),d=o("./client/lib/posts/stats.js"),u=o("./client/post-editor/editor-location/search.jsx"),p="https://maps.google.com/maps/api/staticmap?";t.default=s.createClass({displayName:"EditorLocation",propTypes:{label:s.PropTypes.string,coordinates:function(e,t){var o=e[t];if(o&&(!Array.isArray(o)||2!==o.length||2!==o.filter(Number).length))return new Error("Expected array pair of coordinates for prop `"+t+"`.")}},getInitialState:function(){return{error:null}},onGeolocateSuccess:function(e){this.setState({locating:!1}),i.updateMetadata({geo_latitude:e.coords.latitude,geo_longitude:e.coords.longitude}),d.recordStat("location_geolocate_success")},onGeolocateFailure:function(e){this.setState({error:e,locating:!1}),d.recordStat("location_geolocate_failed")},resetError:function(){this.setState({error:null})},geolocate:function(){this.resetError(),this.setState({locating:!0}),navigator.geolocation.getCurrentPosition(this.onGeolocateSuccess,this.onGeolocateFailure,{enableHighAccuracy:!0}),d.recordStat("location_geolocate"),d.recordEvent("Location Geolocated")},clear:function(){i.deleteMetadata(["geo_latitude","geo_longitude"])},onSearchSelect:function(e){i.updateMetadata({geo_latitude:e.geometry.location.lat,geo_longitude:e.geometry.location.lng})},renderCurrentLocation:function(){if(this.props.coordinates){var e=p+l.stringify({markers:this.props.coordinates.join(","),zoom:8,size:"400x300"});return s.createElement("img",{src:e,className:"editor-location__map"})}},render:function(){var e,t;return this.state.error&&(e=s.createElement(a.default,{status:"is-error",onDismissClick:this.resetError,isCompact:!0},this.translate("We couldn't find your current location.",{context:"Post editor geolocation"}))),t=this.state.locating?this.translate("Locatingâ€¦",{context:"Post editor geolocation"}):this.translate("Get current location",{context:"Post editor geolocation"}),s.createElement("div",{className:"editor-location"},e,s.createElement(c,{icon:"location",label:t,empty:!this.props.coordinates,onClick:this.geolocate,onRemove:this.clear,disabled:this.state.locating},this.renderCurrentLocation()),s.createElement(u,{onError:this.onGeolocateFailure,onSelect:this.onSearchSelect}))}}),e.exports=t.default},"./client/post-editor/editor-location/search-result.jsx":function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o("./node_modules/react/react.js"),a=r(n);t.default=a.default.createClass({displayName:"EditorLocationSearchResult",propTypes:{result:n.PropTypes.object.isRequired,onClick:n.PropTypes.func},getDefaultProps:function(){return{onClick:function(){}}},render:function(){var e=this.props,t=e.result,o=e.onClick;return a.default.createElement("div",{onClick:o,className:"editor-location__search-result"},t.formatted_address)}}),e.exports=t.default},"./client/post-editor/editor-location/search.jsx":function(e,t,o){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=o("./node_modules/react/react.js"),s=n(a),l=o("./client/lib/geocoding/index.js"),i=o("./client/lib/posts/stats.js"),c=r(i),d=o("./client/components/search-card/index.jsx"),u=n(d),p=o("./client/post-editor/editor-location/search-result.jsx"),f=n(p);t.default=s.default.createClass({displayName:"EditorLocationSearch",propTypes:{onError:a.PropTypes.func,onSelect:a.PropTypes.func},getDefaultProps:function(){return{onError:function(){},onSelect:function(){}}},getInitialState:function(){return{results:[],isSearching:!1}},componentDidMount:function(){this.mounted=!0,this.hasTrackedStats=!1},componentWillUnmount:function(){this.mounted=!1},geocode:function(e){var t=this,o=this.props.onError;return this.hasTrackedStats||(c.recordStat("location_search"),c.recordEvent("Location Searched"),this.hasTrackedStats=!0),e?((0,l.geocode)(e).then(function(e){t.mounted&&t.setState({results:e})}).catch(o).then(function(){t.mounted&&t.setState({isSearching:!1})}),void this.setState({isSearching:!0})):void this.setState({results:[]})},onSelect:function(e){this.refs.search.clear(),this.props.onSelect(e)},render:function(){var e=this,t=this.state,o=t.results,r=t.isSearching;return s.default.createElement("div",{className:"editor-location__search"},s.default.createElement(u.default,{ref:"search",onSearch:this.geocode,searching:r,delaySearch:!0,compact:!0}),s.default.createElement("ul",{className:"editor-location__search-results"},o.map(function(t){return s.default.createElement("li",{key:t.formatted_address},s.default.createElement(f.default,{result:t,onClick:e.onSelect.bind(null,t)}))})))}}),e.exports=t.default}});